<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¸ å°ˆæ¥­ç´šå‰ä»–å’Œå¼¦åº«</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        :root { --primary: #2c3e50; --accent: #e67e22; --success: #27ae60; --bg: #f8f9fa; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .controls { margin-bottom: 25px; text-align: center; }
        #soundToggle { padding: 12px 24px; font-size: 1rem; font-weight: bold; border: none; border-radius: 50px; cursor: pointer; transition: 0.3s; background-color: #ddd; color: #333; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        #soundToggle.active { background-color: var(--success); color: white; }
        .main-container { display: flex; gap: 30px; max-width: 1100px; width: 100%; flex-wrap: wrap; justify-content: center; }
        .chord-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); flex: 1; min-width: 350px; }
        .chord-btn { padding: 12px 5px; border: 1px solid #eee; background: #fff; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .chord-btn.active { background: var(--accent); color: white; }
        .display-card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; width: 320px; position: sticky; top: 20px; height: fit-content;}
        .status-bar { display: flex; justify-content: space-between; width: 200px; margin: 0 auto 5px auto; font-weight: bold; font-size: 1.2rem; }
        .status-item { width: 20px; text-align: center; }
        .status-x { color: #e74c3c; }
        .status-o { color: var(--success); }
        .fretboard { width: 200px; height: 240px; margin: 0 auto; position: relative; border: 2px solid #444; background: #fff; }
        .string { position: absolute; width: 2px; background: #bbb; height: 100%; }
        .fret { position: absolute; height: 2px; background: #444; width: 100%; }
        .s1{left:100%} .s2{left:80%} .s3{left:60%} .s4{left:40%} .s5{left:20%} .s6{left:0%}
        .f1{top:20%} .f2{top:40%} .f3{top:60%} .f4{top:80%}
        .finger { position: absolute; width: 22px; height: 22px; background: #e74c3c; border-radius: 50%; transform: translate(-50%, -50%); z-index: 10; }
        @media (max-width: 768px) { .chord-grid { grid-template-columns: repeat(4, 1fr); } .main-container { flex-direction: column-reverse; } }
    </style>
</head>
<body>

    <h1>ğŸ¸ å°ˆæ¥­ç´šå‰ä»–å’Œå¼¦åº«</h1>
    
    <div class="controls">
        <button id="soundToggle" onclick="toggleSound()">ğŸ”‡ è²éŸ³ï¼šå·²é—œé–‰</button>
        <p id="loadingMsg" style="font-size: 0.8rem; color: #888; margin-top: 5px;">æ­£åœ¨å•Ÿå‹•éŸ³è¨Šå¼•æ“...</p>
    </div>

    <div class="main-container">
        <div class="chord-grid" id="chordGrid"></div>

        <div class="display-card">
            <div class="status-bar" id="statusBar">
                <div class="status-item"></div><div class="status-item"></div><div class="status-item"></div>
                <div class="status-item"></div><div class="status-item"></div><div class="status-item"></div>
            </div>
            <div class="fretboard" id="fretboard">
                <div class="string s1"></div><div class="string s2"></div><div class="string s3"></div>
                <div class="string s4"></div><div class="string s5"></div><div class="string s6"></div>
                <div class="fret f1"></div><div class="fret f2"></div><div class="fret f3"></div><div class="fret f4"></div>
            </div>
            <h2 id="currentName" style="color: var(--accent); margin-top: 15px;">è«‹é¸æ“‡å’Œå¼¦</h2>
            <p style="font-size: 0.9rem; color: #666;">çµ„æˆéŸ³ï¼š<span id="chordNotes">-</span></p>
        </div>
    </div>

    <script>
        // --- 1. è³‡æ–™åº«èˆ‡ UI ç”Ÿæˆ (æœ€å„ªå…ˆåŸ·è¡Œ) ---
        const chords = {
            "C": { fingers: [{s:5, f:3}, {s:4, f:2}, {s:2, f:1}], status: ["x","o","o","o","o","o"], notes: "C, E, G", freq: ["C3", "E3", "G3", "C4", "E4"] },
            "G": { fingers: [{s:6, f:3}, {s:5, f:2}, {s:1, f:3}], status: ["o","o","o","o","o","o"], notes: "G, B, D", freq: ["G2", "B2", "D3", "G3", "B3", "G4"] },
            "D": { fingers: [{s:3, f:2}, {s:2, f:3}, {s:1, f:2}], status: ["x","x","o","o","o","o"], notes: "D, F#, A", freq: ["D3", "A3", "D4", "F#4"] },
            "A": { fingers: [{s:4, f:2}, {s:3, f:2}, {s:2, f:2}], status: ["x","o","o","o","o","o"], notes: "A, C#, E", freq: ["A2", "E3", "A3", "C#4", "E4"] },
            "E": { fingers: [{s:5, f:2}, {s:4, f:2}, {s:3, f:1}], status: ["o","o","o","o","o","o"], notes: "E, G#, B", freq: ["E2", "B2", "E3", "G#3", "B3", "E4"] },
            "Am": { fingers: [{s:4, f:2}, {s:3, f:2}, {s:2, f:1}], status: ["x","o","o","o","o","o"], notes: "A, C, E", freq: ["A2", "E3", "A3", "C4", "E4"] },
            "Em": { fingers: [{s:5, f:2}, {s:4, f:2}], status: ["o","o","o","o","o","o"], notes: "E, G, B", freq: ["E2", "B2", "E3", "G3", "B3", "E4"] },
            "Dm": { fingers: [{s:3, f:2}, {s:2, f:3}, {s:1, f:1}], status: ["x","x","o","o","o","o"], notes: "D, F, A", freq: ["D3", "A3", "D4", "F4"] },
            "F": { fingers: [{s:6, f:1}, {s:5, f:3}, {s:4, f:3}, {s:3, f:2}, {s:2, f:1}, {s:1, f:1}], status: ["o","o","o","o","o","o"], notes: "F, A, C", freq: ["F2", "C3", "F3", "A3", "C4", "F4"] },
            "Bm": { fingers: [{s:5, f:2}, {s:4, f:4}, {s:3, f:4}, {s:2, f:3}, {s:1, f:2}], status: ["x","o","o","o","o","o"], notes: "B, D, F#", freq: ["B2", "F#3", "B3", "D4", "F#4"] },
            "C7": { fingers: [{s:5, f:3}, {s:4, f:2}, {s:3, f:3}, {s:2, f:1}], status: ["x","o","o","o","o","o"], notes: "C, E, G, Bb", freq: ["C3", "E3", "Bb3", "C4", "E4"] },
            "G7": { fingers: [{s:6, f:3}, {s
